/*----------------------------------------------------------

author: Ashung Hung
Homepage: https://github.com/Ashung/Automate-Sketch
license: CC-BY 4.0

----------------------------------------------------------*/

var onRun = function(context) {
    var doc = context.document;
    var allSymbolMasters = context.document.documentData().allSymbols();
    var count = 0;
    var loop = allSymbolMasters.objectEnumerator();
    while (symbolMaster = loop.nextObject()) {

        if(!symbolMaster.hasInstances()) {
            symbolMaster.removeFromParent();
            count ++;
        }

        // Or use isSafeToDelete
        // if (symbolMaster.isSafeToDelete()) {
        //     symbolMaster.removeFromParent();
        // }

    }
    doc.showMessage("Remove " + count + " unused SymbolMaster.");
}
